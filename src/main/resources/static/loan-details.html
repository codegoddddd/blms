<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Customer Loan Summaries</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <h1>All Loan Summaries</h1>

    <table class="table table-bordered table-striped" id="loanSummaryTable">
        <thead>
        <tr>
            <th>Customer ID</th>
            <th>Customer Name</th>
            <th>Customer Address</th>
            <th>Total Loan Amount</th>
        </tr>
        </thead>
        <tbody id="loanSummaryTableBody">
        </tbody>
    </table>

    <a href="/" class="btn btn-secondary mt-3">Back to Home</a>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get the table body element
        const tableBody = document.getElementById('loanSummaryTableBody');

        // Make an API call to the new REST endpoint for summaries
        fetch('/api/loan-summaries')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Loop through the array of aggregated data objects
                data.forEach(loanSummary => {
                    // Create a new table row
                    const row = document.createElement('tr');

                    // Create table cells for each data point from the DTO
                    const customerIdCell = document.createElement('td');
                    customerIdCell.textContent = loanSummary.customerId;

                    const customerNameCell = document.createElement('td');
                    customerNameCell.textContent = loanSummary.customerName;

                    const customerAddressCell = document.createElement('td');
                    customerAddressCell.textContent = loanSummary.customerAddress;

                    const totalLoanAmountCell = document.createElement('td');
                    totalLoanAmountCell.textContent = loanSummary.totalLoanAmount;

                    // Append the cells to the row
                    row.appendChild(customerIdCell);
                    row.appendChild(customerNameCell);
                    row.appendChild(customerAddressCell);
                    row.appendChild(totalLoanAmountCell);

                    // Append the row to the table body
                    tableBody.appendChild(row);
                });
            })
            .catch(error => {
                console.error('Error fetching loan summaries:', error);
                tableBody.innerHTML = '<tr><td colspan="4" style="color: red;">Failed to load data. Please try again later.</td></tr>';
            });
    });
</script>

</body>
</html>


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Loan Application Details</title>-->
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">-->
<!--</head>-->
<!--<body>-->

<!--<h1>All Loan Details</h1>-->

<!--<table class="table table-bordered table-striped" id="loanTable">-->
<!--    <thead>-->
<!--    <tr>-->
<!--        <th>Customer ID</th>-->
<!--        <th>Customer Name</th>-->
<!--        <th>Customer Address</th>-->
<!--        <th>Loan Type</th>-->
<!--        <th>Loan Amount</th>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody id="loanTableBody">-->
<!--    </tbody>-->
<!--</table>-->
<!--<a href="/" class="btn btn-secondary mt-3">Back to Home</a>-->
<!--<script>-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        // Get the table body element-->
<!--        const tableBody = document.getElementById('loanTableBody');-->

<!--        // Make an API call to the REST endpoint-->
<!--        fetch('/api/loan-details')-->
<!--            .then(response => {-->
<!--                // Check if the response was successful-->
<!--                if (!response.ok) {-->
<!--                    throw new Error('Network response was not ok');-->
<!--                }-->
<!--                // Parse the JSON data from the response-->
<!--                return response.json();-->
<!--            })-->
<!--            .then(data => {-->
<!--                // Loop through the array of data objects-->
<!--                data.forEach(loanDetail => {-->
<!--                    // Create a new table row-->
<!--                    const row = document.createElement('tr');-->

<!--                    // Create table cells for each data point-->
<!--                    const customerIdCell = document.createElement('td');-->
<!--                    customerIdCell.textContent = loanDetail.customerId;-->

<!--                    const customerNameCell = document.createElement('td');-->
<!--                    customerNameCell.textContent = loanDetail.customerName;-->

<!--                    const customerAddressCell = document.createElement('td');-->
<!--                    customerAddressCell.textContent = loanDetail.customerAddress;-->

<!--                    const loanProductNameCell = document.createElement('td');-->
<!--                    loanProductNameCell.textContent = loanDetail.loanProductName;-->

<!--                    const loanAmountCell = document.createElement('td');-->
<!--                    loanAmountCell.textContent = loanDetail.loanAmount;-->

<!--                    // Append the cells to the row-->
<!--                    row.appendChild(customerIdCell);-->
<!--                    row.appendChild(customerNameCell);-->
<!--                    row.appendChild(customerAddressCell);-->
<!--                    row.appendChild(loanProductNameCell);-->
<!--                    row.appendChild(loanAmountCell);-->

<!--                    // Append the row to the table body-->
<!--                    tableBody.appendChild(row);-->
<!--                });-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error fetching loan details:', error);-->
<!--                // Display an error message to the user-->
<!--                tableBody.innerHTML = '<tr><td colspan="5" style="color: red;">Failed to load data. Please try again later.</td></tr>';-->
<!--            });-->
<!--    });-->
<!--</script>-->

<!--</body>-->
<!--</html>-->

